{
 :default {:impl :ollama :model "llama3.2"}
 :party-pack
 {:start     :fork
  :max-steps 10

  :steps
  {;; Fork two creative branches at once
   :fork     {:parallel [:menu :playlist]
              :join     {:strategy :all :merge :concat-texts}
              :next     :format}

   :menu     {:prompt "You're planning **{{prompt}}**.\nGive 5 fun finger-food ideas that match this theme.\nReturn a short bulleted list."
              :next   :done}

   :playlist {:prompt "You're hosting **{{prompt}}**.\nCreate a 10-song upbeat playlist that fits this vibe, spanning different eras.\nReturn one line per song: Artist â€” Title."
              :next   :done}

   ;; Post-join formatter (single LLM step) consuming the merged text
   :format   {:prompt "Combine and tidy this party pack into one message:\n\n{{obs.merged.text}}\n\nAdd a cheerful closing line."
              :next   :notify}

   :notify   {:tool             :notify
              :message-template "ðŸŽ‰ PARTY PACK ðŸŽ‰\n\n{{obs.text}}"
              :terminal?        true}}

  :tools
  {:notify {:fn   pyjama.tools.notify/notify-user
            :args {:channel "stdout"}}}
  }
 }
